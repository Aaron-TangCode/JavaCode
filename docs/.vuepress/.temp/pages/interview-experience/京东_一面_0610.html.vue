<template><div><ol>
<li>
<p>自我介绍</p>
<ol>
<li>工作介绍的条理不足、说串话、思路不流畅&amp;卡顿</li>
</ol>
</li>
<li>
<p>空窗期7个月在干嘛？中间有做相关的工作吗？</p>
</li>
</ol>
<pre><code>1.  答：年后找工作，因为招聘需求萎缩，没找到合适的。期间没做过相关工作
2.  【更优解】年后才找工作，因为招聘需求萎缩、行情变化，一开始没理清自己要找的公司的目标。期间有在学习相关技术、补足自身短板，还参加了一个自媒体博主用来卖课的项目，是无偿参与的，在里面承担了两个功能的编写，有维持代码手感的。
</code></pre>
<ol start="3">
<li>
<p>ConcurrentHashMap里面1.7和1.8里面有一块变化，这块变化你知道吗？</p>
<ol>
<li>【答漏了】答：变了锁的粒度。jdk1.7会set的时候锁整个底层数据结构，jdk1.8改为更细粒度的锁。</li>
<li>【正解】</li>
<li>问：改锁的目的？
答：提高性能，改小这个锁的粒度，可以同时执行更多的写操作。写的时候对读操作的影响的话，读的时候应该也要获取锁吧？应该对读操作也有一定的性能提高。</li>
<li></li>
</ol>
</li>
<li>
<p>数据库里面，InnoDB引擎，索引有哪些？</p>
<ol>
<li>【答错了】答：索引的话，一个是Memory，是基于内存的存储引擎；一个是MyISAM，是一个不支持事务的存储引擎。他们的区别的话，Memory是基于内存的，没有持久化策略，不支持事务。MyISAM不支持事务，性能比较高。InnoDB支持事务，性能也很高。</li>
</ol>
</li>
<li>
<p>MySQL有一个回表的操作，这个回表的操作是什么？</p>
<ol>
<li>答：（磕磕绊绊，意思答出来， 优化了一下）回表是指执行一条sql的时候要查询若干个字段，并且走一个非主键索引，但是呢这个非主键索引里面没有包含我要查的所有字段，这时候就要先走非主键索引先查到主键id，再用主键id去主键索引里面查询对应的记录。</li>
<li>豆包：
1.  定义：当 SQL 查询通过索引获取到数据的<strong>主键值</strong>后，需要再根据主键值到<strong>聚簇索引（主键索引）</strong> 中查询完整数据记录的过程，称为<strong>回表</strong>。</li>
</ol>
</li>
<li>
<p>mysql后来为什么把它的一个主键索引变成B+树，**？（没听懂问题问了一下，又被提问）它5.6之前是B+树吗？</p>
<ol>
<li>答：这块历史的不了解是否B+树</li>
<li>豆包：一直都是B+树</li>
</ol>
</li>
<li>
<p>mysql里有间隙锁的概念，间隙锁具体的流程和解决的问题是什么？</p>
<ol>
<li>
<p>俺不会</p>
</li>
<li>
<p>豆包：间隙锁是在可重复度 ReapeatableRead隔离界别下特有的锁机制，主要解决幻读问题。
幻读是指在一个事务中，多次执行相同的查询语句，却返回了不同的结果集。
间隙锁通过锁定索引记录之间的 “间隙”，防止其他事务在这些间隙中插入新记录，从而保证查询结果的一致性。</p>
</li>
<li>
<p>间隙锁触流程：</p>
<ol>
<li>
<p>触发条件：当使用<strong>索引条件</strong>进行范围查询（如 <code v-pre>WHERE id &gt; 10 AND id &lt; 20</code>）且<strong>当前隔离级别为可重复读</strong>时，MySQL 会在查询的索引记录之间加间隙锁。</p>
</li>
<li>
<p><strong>锁定范围</strong>
间隙锁不仅锁定存在的记录，还锁定记录之间的 “间隙”。例如：</p>
<div class="language-plaintext line-numbers-mode" data-ext="plaintext"><pre v-pre class="language-plaintext"><code>索引记录：10, 20, 30
间隙锁范围：(-∞, 10), (10, 20), (20, 30), (30, +∞)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li>
<li>
<p><strong>锁的互斥性</strong></p>
<ul>
<li><strong>间隙锁之间不互斥</strong>：不同事务可以同时持有同一间隙的间隙锁。</li>
<li><strong>间隙锁与插入操作互斥</strong>：如果一个事务持有间隙锁，其他事务无法在该间隙插入新记录，直到锁释放。</li>
</ul>
</li>
<li></li>
</ol>
</li>
</ol>
</li>
<li>
<p>redis底层数据结构是跳表，跳表跟链表的数据结构的差别是什么？</p>
</li>
<li>
<p>redis是线程安全的吗？</p>
<ol>
<li>豆包：redis是线程安全的。是基于单线程模型控制的，每个命令的执行是原子性的，执行过程不会被其他命令打断。
如果是集群环境下，redis不支持单个命令跨节点操作数据。</li>
</ol>
</li>
<li>
<p>Redis分布式锁用过？锁的时候用的哪个指令？</p>
<ol>
<li>答：用过，一般用setnx。</li>
<li>追问：那这个解锁下，并发下没有问题吗？</li>
<li>答（非常磕磕绊绊）：并发下设置值是没有问题的，但是删除的话可能会因为多线程操作错误移除别的线程的锁？</li>
<li>【正解1】：锁使用set命令，配置参数NX、PX+过期时间来实现原子性设置  <strong><code v-pre>SET key value NX PX timeout</code></strong> ，删除的话可以通过lua脚本来实现 验证是否当前线程加的锁+移除锁 的原子操作</li>
<li>【正解2】：A线程先获取到锁，正常执行业务逻辑，然后卡住了。过了锁的超时时间后，锁自然释放，B线程再次获取到锁。但是此时A线程复活了，继续执行，会删除对应的锁。A线程删除锁的时候需要验证这把锁是否还是A线程添加的。redisson框架用锁时设置的field为客户端uuid+线程id，value是重入次数</li>
</ol>
</li>
<li>
<p>JVM哪些能作为GC Root节点？</p>
<ol>
<li>答：栈里直接存储的对象、static方法和static变量的对象、native方法</li>
<li>【正解】：
<ol>
<li>jvm虚拟机栈里面所引用的对象（栈帧里的本地变量表）</li>
<li>方法区内静态属性引用的对象</li>
<li>方法区中常量池引用的对象，比如字符串字面量、static final对象</li>
<li>本地方法栈里JNI（native方法）引用的对象</li>
<li>虚拟机内部的引用（类加载器、NPE、OOME等）</li>
<li>被同步锁持有的对象（synchronized关键字）</li>
</ol>
</li>
</ol>
</li>
<li>
<p>超级大对象在JVM里的生命周期？</p>
<ol>
<li>答：超过JVM设置的大对象阈值会直接被分配到老年代，然后只有下一次FullGC了才可能被清除掉</li>
</ol>
</li>
<li>
<p>JVM如何判断一个对象被回收了或者是没被回收？</p>
<ol>
<li>答：基于标记算法，从GCRoot触发找到强引用的对象，标记为不可清除，其他就是可清楚的。</li>
</ol>
</li>
<li>
<p>（说到强引用）什么是虚引用？</p>
<ol>
<li>答：虚引用跟监控对象的生命周期完全独立，主要用于监控目标对象</li>
</ol>
</li>
<li>
<p>Spring中解决循环依赖的时候用了三级缓存，三级缓存中的第二级缓存是什么？</p>
<ol>
<li>答：不记得</li>
</ol>
</li>
<li>
<p>RabbitMQ怎么实现延迟发送和延迟消费？（或者其他MQ也行）</p>
<ol>
<li>答：不懂RabbitMQ的，粗略讲下通用方案，再讲RocketMQ的。
粗略的：主要依赖定时任务扫描哪些消息即将过期，首先是让消息按可投递的时间排序，再用定时任务检查、触发投递
RocketMQ：基于延时等级做的延时队列，假设延时等级有20个队列，第一个是1秒，第二个是3秒，第三个是5秒。如果有一个延时消息进来，选择了一个延时等级进行投递。再把消息记录到延时队列里面，在队列里面它的过期时间是有序的，比如先进来一个延时15分钟的消息，肯定是先出去的，这样就做到了队列里天然有序。然后有一个定时任务定时去检查队列头，把到期的消息投递出去。
其巧妙之处在于利用延时等级存储延时消息，能做到天然有序，避免排序开销。不做这个排序可能会遍历所有消息，可能开销比较大、可能消费的延迟比预期高。</li>
</ol>
</li>
<li>
<p>RocketMQ定时任务扫描，最细的粒度是什么粒度？比如延时15分钟，怎么能准确的做到延时15分钟？</p>
<ol>
<li>答：为了避免太大开销，默认扫描间隔一秒。如果改小开销会导致太大开销，最细粒度就没关注。</li>
<li>【现在想到遗漏的】延时队列里的消息存储在磁盘，但是会在内存保留一份对应映射，只需要扫描内存</li>
</ol>
</li>
<li>
<p>SpringCloud跟Dubbo的注册中心不一样，Nacos注册中心跟Zookeeper相比有什么优势？</p>
<ol>
<li>答：CAP定理，C是一致性、A是可用性、P是分区容错性。主要是讲这3个不能同时并存，nacos注册中心实现的是AP模型，牺牲了一致性。一个分区挂了，可能会有一致性问题，分区里存的老的机器的配置、服务拉了老的nacos的配置，可能造成服务调到了老服务，但是这个后果对于注册中心来说是相对较小的。其他的分区容忍性、可用性，更贴切注册中心的应用场景</li>
</ol>
</li>
<li>
<p>两个注册中心对服务发现和检测逻辑是一样的吗？</p>
<ol>
<li>答：没有对比过</li>
</ol>
</li>
<li>
<p>Dubbo从注册中心已经拿到了地址，这时候注册中心挂了，会出问题吗？</p>
<ol>
<li>答：没了解过，直觉不会出现问题，至少有一个副本可用</li>
</ol>
</li>
</ol>
<p>项目环节</p>
<ol start="21">
<li>酒店系统，QPS高吗？最高的是哪个业务？
<ol>
<li>答：不高，qps100。最高的数据同步业务，他们会把所有平台的信息同步过来做住中服务，比如其他平台的订单、前台手工预定的订单、携程、美团、飞猪这些数据同步过来，qps达到100级。</li>
</ol>
</li>
<li>管理公司下的酒店多吗？
<ol>
<li>600家酒店，也就是大概60000间房？</li>
</ol>
</li>
<li>有没有遇到过什么比较大的问题？
<ol>
<li>答：感觉遇到的问题都是能解决的，解决了的都不是大问题。之前遇到相对比较大的是消息同步，隔壁组同步过来的消息量级翻倍了，这边处理不过来。</li>
<li>追问：幂等性没做好是吧？</li>
<li>答：确实，（解释怎么为什么同步过来的数据量级大，应该解释幂等没做好的原因）。
当时解决方案，先吞掉老消息，再上去重的逻辑。</li>
</ol>
</li>
<li>支付中台改造有一个白名单功能的设计，讲下这个流程？
<ol>
<li>答：有个白名单，请求进来验证用户ID是否在白名单内，如果是的话直接允许走新逻辑。如果是用户请求进来做哈希巴拉巴拉，基于hash值控制能否走新功能。</li>
<li>追问：这个功能是app上的还是h5的？</li>
<li>答：影响app、微信&amp;支付宝小程序</li>
<li>追问：切流对app版本有影响吗？</li>
<li>答：有关系，新的接入方式要用新的sdk，所以要控制版本。小程序强更的，app有影响</li>
<li>追问：切流跟app版本控制是咋做的？</li>
<li>答：旧版本不兼容，老版本不兼容。有两个地方控制，一个是返回可用支付方式的时候能控制，第二个是切流的时候能控制。如果是老版本只允许返回老的。</li>
</ol>
</li>
</ol>
<p>反问环节</p>
<ol start="25">
<li>空缺的岗位情况，主要负责哪块业务？</li>
<li>面试过程中的表现，哪块技能是比较欠缺的？
<ol>
<li>感觉也挺好的，一周内有二面</li>
</ol>
</li>
</ol>
</div></template>


